<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cody Web Chat</title>
    <style>
        .chat-container {
            width: 600px;
            margin: 20px auto;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-family: system-ui;
        }
        .chat-history {
            height: 400px;
            overflow-y: auto;
            padding: 16px;
            background: #f9fafb;
        }
        .message {
            margin: 8px 0;
            padding: 12px;
            border-radius: 6px;
            max-width: 80%;
        }
        .user-message {
            background: #3b82f6;
            color: white;
            margin-left: auto;
        }
        .bot-message {
            background: white;
            border: 1px solid #e5e7eb;
        }
        .code-block {
            position: relative;
            background: #1e293b;
            color: #f8fafc;
            padding: 16px;
            border-radius: 4px;
            margin: 8px 0;
            font-family: Monaco;
            font-size: 14px;
        }
        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #64748b;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
        }
        .input-container {
            display: flex;
            padding: 16px;
            border-top: 1px solid #e5e7eb;
        }
        input {
            flex: 1;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            margin-right: 8px;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-history" id="chatHistory"></div>
        <div class="input-container">
            <input type="text" id="userInput" placeholder="Ask Cody something...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        const ACCESS_TOKEN = 'sgp_fd1b4edb60bf82b8_95e77c87c3d4bd941592b038191d259a70c86f07';
        let chatHistory = [];

        function appendMessage(message, isUser = false) {
            const historyDiv = document.getElementById('chatHistory');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            
            if (typeof message === 'string') {
                messageDiv.textContent = message;
            } else {
                message.forEach(part => {
                    if (part.type === 'code') {
                        const codeBlock = document.createElement('pre');
                        codeBlock.className = 'code-block';
                        codeBlock.textContent = part.content;
                        
                        const copyBtn = document.createElement('button');
                        copyBtn.className = 'copy-btn';
                        copyBtn.textContent = 'Copy';
                        copyBtn.onclick = () => {
                            navigator.clipboard.writeText(part.content);
                            copyBtn.textContent = 'Copied!';
                            setTimeout(() => copyBtn.textContent = 'Copy', 2000);
                        };
                        
                        codeBlock.appendChild(copyBtn);
                        messageDiv.appendChild(codeBlock);
                    } else {
                        const text = document.createElement('div');
                        text.textContent = part.content;
                        messageDiv.appendChild(text);
                    }
                });
            }
            
            historyDiv.appendChild(messageDiv);
            historyDiv.scrollTop = historyDiv.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const question = input.value.trim();
            if (!question) return;

            // Add user message
            chatHistory.push({ role: 'user', content: question });
            appendMessage(question, true);
            input.value = '';

            // Simulate Cody response (replace with actual API call)
            const response = [{
                type: 'text',
                content: 'Here's your code:'
            }, {
                type: 'code',
                content: 'function example() {\n  console.log("Hello Cody!");\n}'
            }];

            // Add bot response
            chatHistory.push({ role: 'assistant', content: response });
            appendMessage(response);
        }
    </script>
</body>
</html>
